{% extends "base.html" %}

{% block title %}Flashcards - SecJob Coach{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>üÉè Cybersecurity Flashcards</h1>
        <p>Review key terms and definitions to reinforce your learning</p>
    </div>
    
    <div class="flashcard-container">
        <div id="flashcard" class="flashcard">
            <div class="flashcard-inner">
                <div class="flashcard-front">
                    <div class="flashcard-content">
                        <p class="flashcard-label">Term</p>
                        <h2 id="card-term"></h2>
                        <p class="flashcard-hint">Click to reveal definition</p>
                    </div>
                </div>
                <div class="flashcard-back">
                    <div class="flashcard-content">
                        <p class="flashcard-label">Definition</p>
                        <p id="card-definition"></p>
                        <p class="flashcard-hint">Click to see term</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="flashcard-controls">
            <div class="card-counter">
                Card <span id="current-card">1</span> of <span id="total-cards">20</span>
            </div>
            <div class="control-buttons">
                <button id="prev-btn" class="btn btn-secondary">‚Üê Previous</button>
                <button id="shuffle-btn" class="btn btn-secondary">üîÄ Shuffle</button>
                <button id="next-btn" class="btn btn-primary">Next ‚Üí</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
let flashcards = [];
let currentIndex = 0;

async function loadFlashcards() {
    try {
        const response = await fetch('/api/flashcards');
        flashcards = await response.json();
        displayCard(0);
    } catch (error) {
        console.error('Error loading flashcards:', error);
    }
}

function displayCard(index) {
    if (flashcards.length === 0) return;
    
    currentIndex = index;
    const card = flashcards[currentIndex];
    
    document.getElementById('card-term').textContent = card.term;
    document.getElementById('card-definition').textContent = card.definition;
    document.getElementById('current-card').textContent = currentIndex + 1;
    document.getElementById('total-cards').textContent = flashcards.length;
    
    // Reset flip state
    const flashcard = document.getElementById('flashcard');
    flashcard.classList.remove('flipped');
    
    // Update button states
    document.getElementById('prev-btn').disabled = currentIndex === 0;
    document.getElementById('next-btn').disabled = currentIndex === flashcards.length - 1;
}

document.getElementById('flashcard').addEventListener('click', function() {
    this.classList.toggle('flipped');
});

document.getElementById('prev-btn').addEventListener('click', () => {
    if (currentIndex > 0) {
        displayCard(currentIndex - 1);
    }
});

document.getElementById('next-btn').addEventListener('click', () => {
    if (currentIndex < flashcards.length - 1) {
        displayCard(currentIndex + 1);
    }
});

document.getElementById('shuffle-btn').addEventListener('click', () => {
    // Fisher-Yates shuffle
    for (let i = flashcards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
    }
    displayCard(0);
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft' && currentIndex > 0) {
        displayCard(currentIndex - 1);
    } else if (e.key === 'ArrowRight' && currentIndex < flashcards.length - 1) {
        displayCard(currentIndex + 1);
    } else if (e.key === ' ') {
        e.preventDefault();
        document.getElementById('flashcard').classList.toggle('flipped');
    }
});

loadFlashcards();
</script>
{% endblock %}
